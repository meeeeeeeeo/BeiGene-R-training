<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>DATETIME</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="config/style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R training</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="RStudioIDE.html">RStudio IDE</a>
</li>
<li>
  <a href="base_R.html">Base R</a>
</li>
<li>
  <a href="tidyverse-base.html">tidyverse base</a>
</li>
<li>
  <a href="stringr_hs.html">stringr</a>
</li>
<li>
  <a href="datetime_qw.html">date and time</a>
</li>
<li>
  <a href="read-write.html">data import/export</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    ggplot2
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="ggplot2_basic.html">basic</a>
    </li>
    <li>
      <a href="ggplot2_layers.html">layers</a>
    </li>
    <li>
      <a href="arranging-plots.html">arranging plots</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="pipe.html">Using pipe</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">focusing on package</li>
    <li>
      <a href="data-process-dplyr.html">data process - dplyr</a>
    </li>
    <li>
      <a href="data-process-tidyr.html">data process - tidyr</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Use SQL in R</li>
    <li>
      <a href="sqldf.html">sqldf</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">DATETIME</h1>

</div>


<div id="dates-date-times-and-times-readr-parse_datetime" class="section level1">
<h1>Dates, date-times, and times <span class="math inline">\(readr-parse\_datetime\)</span></h1>
<pre class="r"><code>library(tidyverse)
library(readr)</code></pre>
<p>You pick between three parsers depending on whether you want a date (the number of days since 1970-01-01), a date-time (the number of seconds since midnight 1970-01-01), or a time (the number of seconds since midnight). When called without any additional arguments:</p>
<ul>
<li><p><code>parse_datetime()</code> expects an ISO8601 date-time. ISO8601 is an international standard in which the components of a date are organised from biggest to smallest: year, month, day, hour, minute, second.</p>
<pre class="r"><code>parse_datetime(&quot;2010-10-01T2010&quot;)
#&gt; [1] &quot;2010-10-01 20:10:00 UTC&quot;
# If time is omitted, it will be set to midnight
parse_datetime(&quot;20101010&quot;)
#&gt; [1] &quot;2010-10-10 UTC&quot;</code></pre></li>
<li><p><code>parse_date()</code> expects a four digit year, a <code>-</code> or <code>/</code>, the month, a <code>-</code> or <code>/</code>, then the day:</p>
<pre class="r"><code>parse_date(&quot;2010-10-01&quot;)
#&gt; [1] &quot;2010-10-01&quot;
parse_date(&quot;2010/10/01&quot;)
#&gt; [1] &quot;2010-10-01&quot;
parse_date(&quot;10/10/01&quot;)
#&gt; Warning: 1 parsing failure.
#&gt; row col   expected   actual
#&gt;   1  -- date like  10/10/01
#&gt; [1] NA
parse_date(&quot;20101001&quot;)
#&gt; Warning: 1 parsing failure.
#&gt; row col   expected   actual
#&gt;   1  -- date like  20101001
#&gt; [1] NA</code></pre></li>
<li><p><code>parse_time()</code> expects the hour, <code>:</code>, minutes, optionally <code>:</code> and seconds, and an optional <code>am</code>/<code>pm</code> specifier:</p>
<pre class="r"><code>library(hms)
parse_time(&quot;01:10 am&quot;)
#&gt; 01:10:00
parse_time(&quot;20:10:01&quot;)
#&gt; 20:10:01</code></pre></li>
</ul>
<p>If these defaults don’t work for your data you can supply your own date-time <code>format</code>, built up of the following pieces:</p>
<dl>
<dt>Year</dt>
<dd><code>%Y</code> (4 digits).
</dd>
<dd><code>%y</code> (2 digits); 00-69 -&gt; 2000-2069, 70-99 -&gt; 1970-1999.
</dd>
<dt>Month</dt>
<dd><code>%m</code> (2 digits).
</dd>
<dd><code>%b</code> (abbreviated name, like “Jan”).
</dd>
<dd><code>%B</code> (full name, “January”).
</dd>
<dt>Day</dt>
<dd><code>%d</code> (2 digits or 1 digit).
</dd>
<dd><code>%e</code> (2 digits).
</dd>
<dt>Time</dt>
<dd><code>%H</code> 0-23 hour.
</dd>
<dd><code>%I</code> 0-12, must be used with <code>%p</code>.
</dd>
<dd><code>%p</code> AM/PM indicator.
</dd>
<dd><code>%M</code> minutes.
</dd>
<dd><code>%S</code> integer seconds.
</dd>
<dd><code>%OS</code> real seconds.
</dd>
<dd><code>%Z</code> Time zone (as name, e.g. <code>America/Chicago</code>, <code>Asia/Shanghai</code>). Beware of abbreviations: if you’re American, note that “EST” is a Canadian time zone that does not have daylight savings time. It is <em>not</em> Eastern Standard Time! We’ll come back to this <a href="#time-zones">time zones</a>.
</dd>
<dd><code>%z</code> (as offset from UTC, e.g. <code>+0800</code>).
</dd>
<dt>Non-digits</dt>
<dd><code>%.</code> skips one non-digit character.
</dd>
<dd><code>%*</code> skips any number of non-digits.
</dd>
</dl>
<p>The best way to figure out the correct format is to create a few examples in a character vector, and test with one of the parsing functions. For example:</p>
<pre class="r"><code>parse_date(&quot;01/02/15&quot;, &quot;%m/%d/%y&quot;)
#&gt; [1] &quot;2015-01-02&quot;
parse_date(&quot;01/02/15&quot;, &quot;%d/%m/%y&quot;)
#&gt; [1] &quot;2015-02-01&quot;
parse_date(&quot;2015年2月1日&quot;, &quot;%Y年%m月%d日&quot;)
#&gt; [1] &quot;2015-02-01&quot;
parse_date(&quot;01/02/15&quot;, &quot;%y/%m/%d&quot;)
#&gt; [1] &quot;2001-02-15&quot;
parse_date(&quot;01/02/15&quot;, &quot;%y%.%m%.%d&quot;)
#&gt; [1] &quot;2001-02-15&quot;
parse_date(&quot;01//02/15&quot;, &quot;%y%*%m%*%d&quot;)
#&gt; [1] &quot;2001-02-15&quot;</code></pre>
<p>If you’re using <code>%b</code> or <code>%B</code> with non-English month names, you’ll need to set the <code>lang</code> argument to <code>locale()</code>. See the list of built-in languages in <code>date_names_langs()</code>, or if your language is not already included, create your own with <code>date_names()</code>.</p>
<pre class="r"><code>date_names_langs()
#&gt;   [1] &quot;af&quot;  &quot;agq&quot; &quot;ak&quot;  &quot;am&quot;  &quot;ar&quot;  &quot;as&quot;  &quot;asa&quot; &quot;az&quot;  &quot;bas&quot; &quot;be&quot;  &quot;bem&quot; &quot;bez&quot;
#&gt;  [13] &quot;bg&quot;  &quot;bm&quot;  &quot;bn&quot;  &quot;bo&quot;  &quot;br&quot;  &quot;brx&quot; &quot;bs&quot;  &quot;ca&quot;  &quot;cgg&quot; &quot;chr&quot; &quot;cs&quot;  &quot;cy&quot; 
#&gt;  [25] &quot;da&quot;  &quot;dav&quot; &quot;de&quot;  &quot;dje&quot; &quot;dsb&quot; &quot;dua&quot; &quot;dyo&quot; &quot;dz&quot;  &quot;ebu&quot; &quot;ee&quot;  &quot;el&quot;  &quot;en&quot; 
#&gt;  [37] &quot;eo&quot;  &quot;es&quot;  &quot;et&quot;  &quot;eu&quot;  &quot;ewo&quot; &quot;fa&quot;  &quot;ff&quot;  &quot;fi&quot;  &quot;fil&quot; &quot;fo&quot;  &quot;fr&quot;  &quot;fur&quot;
#&gt;  [49] &quot;fy&quot;  &quot;ga&quot;  &quot;gd&quot;  &quot;gl&quot;  &quot;gsw&quot; &quot;gu&quot;  &quot;guz&quot; &quot;gv&quot;  &quot;ha&quot;  &quot;haw&quot; &quot;he&quot;  &quot;hi&quot; 
#&gt;  [61] &quot;hr&quot;  &quot;hsb&quot; &quot;hu&quot;  &quot;hy&quot;  &quot;id&quot;  &quot;ig&quot;  &quot;ii&quot;  &quot;is&quot;  &quot;it&quot;  &quot;ja&quot;  &quot;jgo&quot; &quot;jmc&quot;
#&gt;  [73] &quot;ka&quot;  &quot;kab&quot; &quot;kam&quot; &quot;kde&quot; &quot;kea&quot; &quot;khq&quot; &quot;ki&quot;  &quot;kk&quot;  &quot;kkj&quot; &quot;kl&quot;  &quot;kln&quot; &quot;km&quot; 
#&gt;  [85] &quot;kn&quot;  &quot;ko&quot;  &quot;kok&quot; &quot;ks&quot;  &quot;ksb&quot; &quot;ksf&quot; &quot;ksh&quot; &quot;kw&quot;  &quot;ky&quot;  &quot;lag&quot; &quot;lb&quot;  &quot;lg&quot; 
#&gt;  [97] &quot;lkt&quot; &quot;ln&quot;  &quot;lo&quot;  &quot;lt&quot;  &quot;lu&quot;  &quot;luo&quot; &quot;luy&quot; &quot;lv&quot;  &quot;mas&quot; &quot;mer&quot; &quot;mfe&quot; &quot;mg&quot; 
#&gt; [109] &quot;mgh&quot; &quot;mgo&quot; &quot;mk&quot;  &quot;ml&quot;  &quot;mn&quot;  &quot;mr&quot;  &quot;ms&quot;  &quot;mt&quot;  &quot;mua&quot; &quot;my&quot;  &quot;naq&quot; &quot;nb&quot; 
#&gt; [121] &quot;nd&quot;  &quot;ne&quot;  &quot;nl&quot;  &quot;nmg&quot; &quot;nn&quot;  &quot;nnh&quot; &quot;nus&quot; &quot;nyn&quot; &quot;om&quot;  &quot;or&quot;  &quot;os&quot;  &quot;pa&quot; 
#&gt; [133] &quot;pl&quot;  &quot;ps&quot;  &quot;pt&quot;  &quot;qu&quot;  &quot;rm&quot;  &quot;rn&quot;  &quot;ro&quot;  &quot;rof&quot; &quot;ru&quot;  &quot;rw&quot;  &quot;rwk&quot; &quot;sah&quot;
#&gt; [145] &quot;saq&quot; &quot;sbp&quot; &quot;se&quot;  &quot;seh&quot; &quot;ses&quot; &quot;sg&quot;  &quot;shi&quot; &quot;si&quot;  &quot;sk&quot;  &quot;sl&quot;  &quot;smn&quot; &quot;sn&quot; 
#&gt; [157] &quot;so&quot;  &quot;sq&quot;  &quot;sr&quot;  &quot;sv&quot;  &quot;sw&quot;  &quot;ta&quot;  &quot;te&quot;  &quot;teo&quot; &quot;th&quot;  &quot;ti&quot;  &quot;to&quot;  &quot;tr&quot; 
#&gt; [169] &quot;twq&quot; &quot;tzm&quot; &quot;ug&quot;  &quot;uk&quot;  &quot;ur&quot;  &quot;uz&quot;  &quot;vai&quot; &quot;vi&quot;  &quot;vun&quot; &quot;wae&quot; &quot;xog&quot; &quot;yav&quot;
#&gt; [181] &quot;yi&quot;  &quot;yo&quot;  &quot;zgh&quot; &quot;zh&quot;  &quot;zu&quot;
parse_date(&quot;1 janvier 2015&quot;, &quot;%d %B %Y&quot;, locale = locale(&quot;fr&quot;))
#&gt; [1] &quot;2015-01-01&quot;
parse_datetime(&quot;1 enero 2015&quot;, &quot;%d %B %Y&quot;, locale = locale(&quot;es&quot;))
#&gt; [1] &quot;2015-01-01 UTC&quot;

# Time zones
Sys.time()
#&gt; [1] &quot;2021-10-25 20:52:42 PDT&quot;
Sys.timezone()
#&gt; [1] &quot;America/Los_Angeles&quot;
a &lt;- parse_datetime(as.character(Sys.time()), locale = locale(tz = &quot;America/Los_Angeles&quot;))
a
#&gt; [1] &quot;2021-10-25 20:52:42 PDT&quot;
as.numeric(a)
#&gt; [1] 1635220362

b &lt;- parse_datetime(as.character(Sys.time()), locale = locale(tz = &quot;Asia/Shanghai&quot;))
b
#&gt; [1] &quot;2021-10-25 20:52:42 CST&quot;
as.numeric(b)
#&gt; [1] 1635166362

# Your current time zone
d &lt;- Sys.time();
attributes(d)$tzone &lt;- &quot;Asia/Shanghai&quot;
d
#&gt; [1] &quot;2021-10-26 11:52:42 CST&quot;
as.numeric(d)
#&gt; [1] 1635220362</code></pre>
<div id="exercises" class="section level2">
<h2>Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>Generate the correct format string to parse each of the following dates and times:</p>
<pre class="r"><code>d1 &lt;- &quot;January 1, 2010&quot;
d2 &lt;- &quot;2015-Mar-07&quot;
d3 &lt;- &quot;06-Jun-2017&quot;
d4 &lt;- c(&quot;August 19 (2015)&quot;, &quot;July 1 (2015)&quot;)
d5 &lt;- &quot;12/30/14&quot; # Dec 30, 2014
t1 &lt;- &quot;1705&quot;
t2 &lt;- &quot;11:15:10.12 PM&quot;</code></pre></li>
</ol>
</div>
</div>
<div id="dates-date-times-and-times-lubridate-datetimes" class="section level1">
<h1>Dates, date-times, and times <span class="math inline">\(lubridate-datetimes\)</span></h1>
<div id="prerequisites" class="section level2">
<h2>Prerequisites</h2>
<ul>
<li><p>This chapter will focus on the <strong>lubridate</strong> package, which makes it easier to work with dates and times in R. lubridate is not part of core tidyverse because you only need it when you’re working with dates/times. We will also need <strong>nycflights13</strong> for practice data.</p>
<pre class="r"><code>library(tidyverse)
library(lubridate)
library(nycflights13)</code></pre></li>
</ul>
</div>
<div id="creating-datetimes" class="section level2">
<h2>Creating date/times</h2>
<ul>
<li><p>There are three types of date/time data that refer to an instant in time:</p>
<ul>
<li><p>A <strong>date</strong>. Tibbles print this as <code>&lt;date&gt;</code>.</p></li>
<li><p>A <strong>time</strong> within a day. Tibbles print this as <code>&lt;time&gt;</code>.</p></li>
<li><p>A <strong>date-time</strong> is a date plus a time: it uniquely identifies an instant in time (typically to the nearest second). Tibbles print this as <code>&lt;dttm&gt;</code>. Elsewhere in R these are called POSIXct, but I don’t think that’s a very useful name. In this chapter we are only going to focus on dates and date-times as R doesn’t have a native class for storing times. If you need one, you can use the <strong>hms</strong> package.</p></li>
</ul>
<p>To get the current date or date-time you can use <code>today()</code> or <code>now()</code>:</p>
<pre class="r"><code>today()
#&gt; [1] &quot;2021-10-25&quot;
now()
#&gt; [1] &quot;2021-10-25 20:52:42 PDT&quot;</code></pre>
<p>Otherwise, there are three ways you’re likely to create a date/time:</p>
<ul>
<li>From a string.</li>
<li>From individual date-time components.</li>
<li>From an existing date/time object.</li>
</ul></li>
</ul>
<div id="from-strings" class="section level3">
<h3>From strings</h3>
<ul>
<li><p>Date/time data often comes as strings. You’ve seen one approach to parsing strings into date-times in date-times. Another approach is to use the helpers provided by lubridate. They automatically work out the format once you specify the order of the component. To use them, identify the order in which year, month, and day appear in your dates, then arrange “y”, “m”, and “d” in the same order. That gives you the name of the lubridate function that will parse your date. For example:</p>
<pre class="r"><code>ymd(&quot;2017-01-31&quot;)
#&gt; [1] &quot;2017-01-31&quot;
mdy(&quot;January 31st, 2017&quot;)
#&gt; [1] &quot;2017-01-31&quot;
dmy(&quot;31-Jan-2017&quot;)
#&gt; [1] &quot;2017-01-31&quot;

## m also matches b and B; y also matches Y   
guess_formats(
  c(
    &quot;jan 3   10&quot;,
    &quot;Feb 20th 73&quot;,
    &quot;January 5 1999 at 7pm&quot;,
    &quot;January 5 1999 at pm&quot;,
    &quot;03:23:22 pm&quot;,
    &quot;DOB:12/11/00&quot;
  ),
  orders = &quot;mdy&quot;,
  print_matches = TRUE
)
#&gt;                              Omdy              mdy             
#&gt; [1,] &quot;jan 3   10&quot;            &quot;%Om %d   %y&quot;     &quot;%b %d   %y&quot;    
#&gt; [2,] &quot;Feb 20th 73&quot;           &quot;%Om %dth %y&quot;     &quot;%b %dth %y&quot;    
#&gt; [3,] &quot;January 5 1999 at 7pm&quot; &quot;&quot;                &quot;&quot;              
#&gt; [4,] &quot;January 5 1999 at pm&quot;  &quot;%Om %d %Y at pm&quot; &quot;%B %d %Y at pm&quot;
#&gt; [5,] &quot;03:23:22 pm&quot;           &quot;%Om:%d:%y pm&quot;    &quot;%m:%d:%y pm&quot;   
#&gt; [6,] &quot;DOB:12/11/00&quot;          &quot;DOB:%Om/%d/%y&quot;   &quot;DOB:%m/%d/%y&quot;
#&gt;              Omdy              Omdy              Omdy              Omdy 
#&gt;     &quot;%Om %d   %y&quot;     &quot;%Om %dth %y&quot; &quot;%Om %d %Y at pm&quot;    &quot;%Om:%d:%y pm&quot; 
#&gt;              Omdy               mdy               mdy               mdy 
#&gt;   &quot;DOB:%Om/%d/%y&quot;      &quot;%b %d   %y&quot;      &quot;%b %dth %y&quot;  &quot;%B %d %Y at pm&quot; 
#&gt;               mdy               mdy 
#&gt;     &quot;%m:%d:%y pm&quot;    &quot;DOB:%m/%d/%y&quot;

parse_datetime(&quot;jan 3   10&quot;, &quot;%b %d   %y&quot;)
#&gt; [1] &quot;2010-01-03 UTC&quot;
parse_datetime(&quot;Feb 20th 73&quot;, &quot;%b %dth %y&quot;)
#&gt; [1] &quot;1973-02-20 UTC&quot;
parse_datetime(&quot;January 5 1999 at 7pm&quot;, &quot;%B %d %Y at %I%p&quot;)
#&gt; [1] &quot;1999-01-05 19:00:00 UTC&quot;
parse_datetime(&quot;03:23:22 pm&quot;, &quot;%m:%d:%y pm&quot;)
#&gt; [1] &quot;2022-03-23 UTC&quot;
parse_time(&quot;03:23:22 pm&quot;, &quot;%I:%M:%S %p&quot;)
#&gt; 15:23:22
parse_datetime(&quot;DOB:12/11/00&quot;, &quot;DOB:%m/%d/%y&quot;)
#&gt; [1] &quot;2000-12-11 UTC&quot;

guess_formats(&quot;21 Aug 2011, 11:15:34 pm&quot;, &quot;dmyHMS&quot;, print_matches = TRUE)
#&gt;                                 dOmyHMS                 
#&gt; [1,] &quot;21 Aug 2011, 11:15:34 pm&quot; &quot;%d %Om %Y, %H:%M:%S pm&quot;
#&gt;      dmyHMS                 
#&gt; [1,] &quot;%d %b %Y, %H:%M:%S pm&quot;
#&gt;                  dOmyHMS                   dmyHMS 
#&gt; &quot;%d %Om %Y, %H:%M:%S pm&quot;  &quot;%d %b %Y, %H:%M:%S pm&quot;
parse_datetime(&quot;21 Aug 2011, 11:15:34 pm&quot;, &quot;%d %b %Y, %H:%M:%S pm&quot;)
#&gt; [1] &quot;2011-08-21 11:15:34 UTC&quot;
parse_datetime(&quot;21 Aug 2011, 11:15:34 pm&quot;, &quot;%d %b %Y, %I:%M:%S %p&quot;)
#&gt; [1] &quot;2011-08-21 23:15:34 UTC&quot;</code></pre>
<p>These functions also take unquoted numbers. This is the most concise way to create a single date/time object, as you might need when filtering date/time data. <code>ymd()</code> is short and unambiguous:</p>
<pre class="r"><code>ymd(20170131)
#&gt; [1] &quot;2017-01-31&quot;
ymd(170131)
#&gt; [1] &quot;2017-01-31&quot;</code></pre>
<p><code>ymd()</code> and friends create dates. To create a date-time, add an underscore and one or more of “h”, “m”, and “s” to the name of the parsing function:</p>
<pre class="r"><code>ymd_hms(&quot;2017-01-31 20:11:59&quot;)
#&gt; [1] &quot;2017-01-31 20:11:59 UTC&quot;
mdy_hm(&quot;01/31/2017 08:01&quot;)
#&gt; [1] &quot;2017-01-31 08:01:00 UTC&quot;</code></pre>
<p>You can also force the creation of a date-time from a date by supplying a timezone:</p>
<pre class="r"><code>ymd(20170131, tz = &quot;UTC&quot;)
#&gt; [1] &quot;2017-01-31 UTC&quot;</code></pre></li>
</ul>
</div>
<div id="from-individual-components" class="section level3">
<h3>From individual components</h3>
<ul>
<li><p>Instead of a single string, sometimes you’ll have the individual components of the date-time spread across multiple columns. To create a date/time from this sort of input, use <code>make_date()</code> for dates, or <code>make_datetime()</code> for date-times:</p>
<pre class="r"><code>flights %&gt;% 
  select(year, month, day, hour, minute) %&gt;% 
  mutate(departure = make_datetime(year, month, day, hour, minute))
#&gt; # A tibble: 336,776 x 6
#&gt;    year month   day  hour minute departure          
#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dttm&gt;             
#&gt; 1  2013     1     1     5     15 2013-01-01 05:15:00
#&gt; 2  2013     1     1     5     29 2013-01-01 05:29:00
#&gt; 3  2013     1     1     5     40 2013-01-01 05:40:00
#&gt; 4  2013     1     1     5     45 2013-01-01 05:45:00
#&gt; 5  2013     1     1     6      0 2013-01-01 06:00:00
#&gt; # … with 336,771 more rows</code></pre>
<p>Let’s do the same thing for each of the four time columns in <code>flights</code>. The times are represented in a slightly odd format, so we use modulus arithmetic to pull out the hour and minute components. Once I’ve created the date-time variables, I focus in on the variables we’ll explore in the rest of the chapter.</p>
<pre class="r"><code>make_datetime_100 &lt;- function(year, month, day, time) {
  make_datetime(year, month, day, time %/% 100, time %% 100)
}

flights_dt &lt;- flights %&gt;% 
  filter(!is.na(dep_time), !is.na(arr_time)) %&gt;% 
  mutate(
    dep_time = make_datetime_100(year, month, day, dep_time),
    arr_time = make_datetime_100(year, month, day, arr_time),
    sched_dep_time = make_datetime_100(year, month, day, sched_dep_time),
    sched_arr_time = make_datetime_100(year, month, day, sched_arr_time)
  ) %&gt;% 
  select(origin, dest, ends_with(&quot;delay&quot;), ends_with(&quot;time&quot;))

flights_dt
#&gt; # A tibble: 328,063 x 9
#&gt;   origin dest  dep_delay arr_delay dep_time            sched_dep_time     
#&gt;   &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dttm&gt;              &lt;dttm&gt;             
#&gt; 1 EWR    IAH           2        11 2013-01-01 05:17:00 2013-01-01 05:15:00
#&gt; 2 LGA    IAH           4        20 2013-01-01 05:33:00 2013-01-01 05:29:00
#&gt; 3 JFK    MIA           2        33 2013-01-01 05:42:00 2013-01-01 05:40:00
#&gt; 4 JFK    BQN          -1       -18 2013-01-01 05:44:00 2013-01-01 05:45:00
#&gt; 5 LGA    ATL          -6       -25 2013-01-01 05:54:00 2013-01-01 06:00:00
#&gt; # … with 328,058 more rows, and 3 more variables: arr_time &lt;dttm&gt;,
#&gt; #   sched_arr_time &lt;dttm&gt;, air_time &lt;dbl&gt;</code></pre></li>
</ul>
</div>
<div id="from-other-types" class="section level3">
<h3>From other types</h3>
<ul>
<li><p>You may want to switch between a date-time and a date. That’s the job of <code>as_datetime()</code> and <code>as_date()</code>:</p>
<pre class="r"><code>as_datetime(today())
#&gt; [1] &quot;2021-10-25 UTC&quot;
as_date(now())
#&gt; [1] &quot;2021-10-25&quot;</code></pre>
<p>Sometimes you’ll get date/times as numeric offsets from the “Unix Epoch”, 1970-01-01. If the offset is in seconds, use <code>as_datetime()</code>; if it’s in days, use <code>as_date()</code>.</p>
<pre class="r"><code>as_datetime(60 * 60 * 10)
#&gt; [1] &quot;1970-01-01 10:00:00 UTC&quot;
as_date(365 * 10 + 2)
#&gt; [1] &quot;1980-01-01&quot;</code></pre></li>
</ul>
</div>
</div>
<div id="date-time-components" class="section level2">
<h2>Date-time components</h2>
<ul>
<li>Now that you know how to get date-time data into R’s date-time data structures, let’s explore what you can do with them. This section will focus on the accessor functions that let you get and set individual components. The next section will look at how arithmetic works with date-times.</li>
</ul>
<div id="getting-components" class="section level3">
<h3>Getting components</h3>
<ul>
<li><p>You can pull out individual parts of the date with the accessor functions <code>year()</code>, <code>month()</code>, <code>mday()</code> (day of the month), <code>yday()</code> (day of the year), <code>wday()</code> (day of the week), <code>hour()</code>, <code>minute()</code>, and <code>second()</code>.</p>
<pre class="r"><code>datetime &lt;- ymd_hms(&quot;2016-07-08 12:34:56&quot;)

year(datetime)
#&gt; [1] 2016
month(datetime)
#&gt; [1] 7
mday(datetime)
#&gt; [1] 8

yday(datetime)
#&gt; [1] 190
wday(datetime)
#&gt; [1] 6</code></pre>
<p>For <code>month()</code> and <code>wday()</code> you can set <code>label = TRUE</code> to return the abbreviated name of the month or day of the week. Set <code>abbr = FALSE</code> to return the full name.</p>
<pre class="r"><code>month(datetime, label = TRUE)
#&gt; [1] Jul
#&gt; 12 Levels: Jan &lt; Feb &lt; Mar &lt; Apr &lt; May &lt; Jun &lt; Jul &lt; Aug &lt; Sep &lt; ... &lt; Dec
wday(datetime, label = TRUE, abbr = FALSE)
#&gt; [1] Friday
#&gt; 7 Levels: Sunday &lt; Monday &lt; Tuesday &lt; Wednesday &lt; Thursday &lt; ... &lt; Saturday</code></pre></li>
</ul>
</div>
<div id="rounding" class="section level3">
<h3>Rounding</h3>
<ul>
<li><p>An alternative approach to plotting individual components is to round the date to a nearby unit of time, with <code>floor_date()</code>, <code>round_date()</code>, and <code>ceiling_date()</code>. Each function takes a vector of dates to adjust and then the name of the unit round down (floor), round up (ceiling), or round to.</p>
<pre class="r"><code>Sys.time()
#&gt; [1] &quot;2021-10-25 20:52:44 PDT&quot;
round_date(Sys.time(), &#39;2 hours&#39;)
#&gt; [1] &quot;2021-10-25 20:00:00 PDT&quot;
ceiling_date(Sys.time(), &#39;2 hours&#39;)
#&gt; [1] &quot;2021-10-25 22:00:00 PDT&quot;
floor_date(Sys.time(), &#39;2 hours&#39;)
#&gt; [1] &quot;2021-10-25 20:00:00 PDT&quot;</code></pre></li>
</ul>
</div>
<div id="setting-components" class="section level3">
<h3>Setting components</h3>
<ul>
<li><p>You can also use each accessor function to set the components of a date/time:</p>
<pre class="r"><code>datetime &lt;- ymd_hms(&quot;2016-07-08 12:34:56&quot;)

year(datetime) &lt;- 2020
datetime
#&gt; [1] &quot;2020-07-08 12:34:56 UTC&quot;
month(datetime) &lt;- 01
datetime
#&gt; [1] &quot;2020-01-08 12:34:56 UTC&quot;
hour(datetime) &lt;- hour(datetime) + 1
datetime
#&gt; [1] &quot;2020-01-08 13:34:56 UTC&quot;</code></pre>
<p>Alternatively, rather than modifying in place, you can create a new date-time with <code>update()</code>. This also allows you to set multiple values at once.</p>
<pre class="r"><code>update(datetime, year = 2020, month = 2, mday = 2, hour = 2)
#&gt; [1] &quot;2020-02-02 02:34:56 UTC&quot;</code></pre>
<p>If values are too big, they will roll-over:</p>
<pre class="r"><code>ymd(&quot;2015-02-01&quot;) %&gt;% update(mday = 30)
#&gt; [1] &quot;2015-03-02&quot;
ymd(&quot;2015-02-01&quot;) %&gt;% update(hour = 400)
#&gt; [1] &quot;2015-02-17 16:00:00 UTC&quot;</code></pre></li>
</ul>
</div>
</div>
<div id="time-spans" class="section level2">
<h2>Time spans</h2>
<ul>
<li><p>Next you’ll learn about how arithmetic with dates works, including subtraction, addition, and division. Along the way, you’ll learn about three important classes that represent time spans:</p>
<ul>
<li><strong>durations</strong>, which represent an exact number of seconds.</li>
<li><strong>periods</strong>, which represent human units like weeks and months.</li>
<li><strong>intervals</strong>, which represent a starting and ending point.</li>
</ul></li>
</ul>
<div id="durations" class="section level3">
<h3>Durations</h3>
<ul>
<li><p>In R, when you subtract two dates, you get a difftime object:</p>
<pre class="r"><code>h_age &lt;- today() - ymd(19791014)
h_age
#&gt; Time difference of 15352 days</code></pre>
<p>A difftime class object records a time span of seconds, minutes, hours, days, or weeks. This ambiguity can make difftimes a little painful to work with, so lubridate provides an alternative which always uses seconds: the <strong>duration</strong>.</p>
<pre class="r"><code>as.duration(h_age)
#&gt; [1] &quot;1326412800s (~42.03 years)&quot;</code></pre>
<p>Durations come with a bunch of convenient constructors:</p>
<pre class="r"><code>dseconds(15)
#&gt; [1] &quot;15s&quot;
dminutes(10)
#&gt; [1] &quot;600s (~10 minutes)&quot;
dhours(c(12, 24))
#&gt; [1] &quot;43200s (~12 hours)&quot; &quot;86400s (~1 days)&quot;
ddays(0:5)
#&gt; [1] &quot;0s&quot;                &quot;86400s (~1 days)&quot;  &quot;172800s (~2 days)&quot;
#&gt; [4] &quot;259200s (~3 days)&quot; &quot;345600s (~4 days)&quot; &quot;432000s (~5 days)&quot;
dweeks(3)
#&gt; [1] &quot;1814400s (~3 weeks)&quot;
dyears(1)
#&gt; [1] &quot;31557600s (~1 years)&quot;</code></pre>
<p>Durations always record the time span in seconds. Larger units are created by converting minutes, hours, days, weeks, and years to seconds at the standard rate (60 seconds in a minute, 60 minutes in an hour, 24 hours in day, 7 days in a week, 365 days in a year).</p>
<p>You can add and multiply durations:</p>
<pre class="r"><code>2 * dyears(1)
#&gt; [1] &quot;63115200s (~2 years)&quot;
dyears(1) + dweeks(12) + dhours(15)
#&gt; [1] &quot;38869200s (~1.23 years)&quot;</code></pre>
<p>You can add and subtract durations to and from days:</p>
<pre class="r"><code>tomorrow &lt;- today() + ddays(1)
last_year &lt;- today() - dyears(1)</code></pre>
<p>However, because durations represent an exact number of seconds, sometimes you might get an unexpected result:</p>
<pre class="r"><code>one_pm &lt;- ymd_hms(&quot;2016-03-12 13:00:00&quot;, tz = &quot;America/New_York&quot;)

one_pm
#&gt; [1] &quot;2016-03-12 13:00:00 EST&quot;
one_pm + ddays(1)
#&gt; [1] &quot;2016-03-13 14:00:00 EDT&quot;

one_pm &lt;- ymd_hms(&quot;2016-03-12 13:00:00&quot;, tz = &quot;Asia/Shanghai&quot;)

one_pm
#&gt; [1] &quot;2016-03-12 13:00:00 CST&quot;
one_pm + ddays(1)
#&gt; [1] &quot;2016-03-13 13:00:00 CST&quot;</code></pre></li>
</ul>
</div>
<div id="periods" class="section level3">
<h3>Periods</h3>
<ul>
<li><p>To solve this problem, lubridate provides <strong>periods</strong>. Periods are time spans but don’t have a fixed length in seconds, instead they work with “human” times, like days and months. That allows them work in a more intuitive way:</p>
<pre class="r"><code>one_pm
#&gt; [1] &quot;2016-03-12 13:00:00 CST&quot;
one_pm + days(1)
#&gt; [1] &quot;2016-03-13 13:00:00 CST&quot;</code></pre>
<p>Like durations, periods can be created with a number of friendly constructor functions.</p>
<pre class="r"><code>seconds(15)
#&gt; [1] &quot;15S&quot;
minutes(10)
#&gt; [1] &quot;10M 0S&quot;
hours(c(12, 24))
#&gt; [1] &quot;12H 0M 0S&quot; &quot;24H 0M 0S&quot;
days(7)
#&gt; [1] &quot;7d 0H 0M 0S&quot;
months(1:6)
#&gt; [1] &quot;1m 0d 0H 0M 0S&quot; &quot;2m 0d 0H 0M 0S&quot; &quot;3m 0d 0H 0M 0S&quot; &quot;4m 0d 0H 0M 0S&quot;
#&gt; [5] &quot;5m 0d 0H 0M 0S&quot; &quot;6m 0d 0H 0M 0S&quot;
weeks(3)
#&gt; [1] &quot;21d 0H 0M 0S&quot;
years(1)
#&gt; [1] &quot;1y 0m 0d 0H 0M 0S&quot;</code></pre>
<p>You can add and multiply periods:</p>
<pre class="r"><code>10 * (months(6) + days(1))
#&gt; [1] &quot;60m 10d 0H 0M 0S&quot;
days(50) + hours(25) + minutes(2)
#&gt; [1] &quot;50d 25H 2M 0S&quot;</code></pre>
<p>And of course, add them to dates. Compared to durations, periods are more likely to do what you expect:</p>
<pre class="r"><code># A leap year
leap_year(2020)
#&gt; [1] TRUE

ymd(&quot;2020-01-01&quot;) + dyears(1)
#&gt; [1] &quot;2020-12-31 06:00:00 UTC&quot;
ymd(&quot;2020-01-01&quot;) + years(1)
#&gt; [1] &quot;2021-01-01&quot;
ymd(&quot;2020-01-01&quot;) + weeks(0:5)
#&gt; [1] &quot;2020-01-01&quot; &quot;2020-01-08&quot; &quot;2020-01-15&quot; &quot;2020-01-22&quot; &quot;2020-01-29&quot;
#&gt; [6] &quot;2020-02-05&quot;

# The last date of the month    
ymd(&quot;2020-01-31&quot;) + months(0:11)
#&gt;  [1] &quot;2020-01-31&quot; NA           &quot;2020-03-31&quot; NA           &quot;2020-05-31&quot;
#&gt;  [6] NA           &quot;2020-07-31&quot; &quot;2020-08-31&quot; NA           &quot;2020-10-31&quot;
#&gt; [11] NA           &quot;2020-12-31&quot;
ymd(&quot;2020-01-31&quot;) %m+% months(0:11)
#&gt;  [1] &quot;2020-01-31&quot; &quot;2020-02-29&quot; &quot;2020-03-31&quot; &quot;2020-04-30&quot; &quot;2020-05-31&quot;
#&gt;  [6] &quot;2020-06-30&quot; &quot;2020-07-31&quot; &quot;2020-08-31&quot; &quot;2020-09-30&quot; &quot;2020-10-31&quot;
#&gt; [11] &quot;2020-11-30&quot; &quot;2020-12-31&quot;

# Daylight Savings Time
one_pm + dmonths(1)  #datetime
#&gt; [1] &quot;2016-04-11 23:30:00 CST&quot;
one_pm + months(1)   #date
#&gt; [1] &quot;2016-04-12 13:00:00 CST&quot;</code></pre>
<p>Let’s use periods to fix an oddity related to our flight dates. Some planes appear to have arrived at their destination <em>before</em> they departed from New York City.</p>
<pre class="r"><code>flights_dt %&gt;% 
  filter(arr_time &lt; dep_time) 
#&gt; # A tibble: 10,633 x 9
#&gt;   origin dest  dep_delay arr_delay dep_time            sched_dep_time     
#&gt;   &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dttm&gt;              &lt;dttm&gt;             
#&gt; 1 EWR    BQN           9        -4 2013-01-01 19:29:00 2013-01-01 19:20:00
#&gt; 2 JFK    DFW          59        NA 2013-01-01 19:39:00 2013-01-01 18:40:00
#&gt; 3 EWR    TPA          -2         9 2013-01-01 20:58:00 2013-01-01 21:00:00
#&gt; 4 EWR    SJU          -6       -12 2013-01-01 21:02:00 2013-01-01 21:08:00
#&gt; 5 EWR    SFO          11       -14 2013-01-01 21:08:00 2013-01-01 20:57:00
#&gt; # … with 10,628 more rows, and 3 more variables: arr_time &lt;dttm&gt;,
#&gt; #   sched_arr_time &lt;dttm&gt;, air_time &lt;dbl&gt;</code></pre>
<p>These are overnight flights. We used the same date information for both the departure and the arrival times, but these flights arrived on the following day. We can fix this by adding <code>days(1)</code> to the arrival time of each overnight flight.</p>
<pre class="r"><code>flights_dt &lt;- flights_dt %&gt;% 
  mutate(
    overnight = arr_time &lt; dep_time,
    arr_time = arr_time + days(overnight * 1),
    sched_arr_time = sched_arr_time + days(overnight * 1)
  )</code></pre>
<p>Now all of our flights obey the laws of physics.</p>
<pre class="r"><code>flights_dt %&gt;% 
  filter(overnight, arr_time &lt; dep_time) 
#&gt; # A tibble: 0 x 10
#&gt; # … with 10 variables: origin &lt;chr&gt;, dest &lt;chr&gt;, dep_delay &lt;dbl&gt;,
#&gt; #   arr_delay &lt;dbl&gt;, dep_time &lt;dttm&gt;, sched_dep_time &lt;dttm&gt;, arr_time &lt;dttm&gt;,
#&gt; #   sched_arr_time &lt;dttm&gt;, air_time &lt;dbl&gt;, overnight &lt;lgl&gt;</code></pre></li>
</ul>
</div>
</div>
<div id="intervals" class="section level2">
<h2>Intervals</h2>
<ul>
<li><p>If you want a more accurate measurement, you’ll have to use an <strong>interval</strong>. An interval is a duration with a starting point: that makes it precise so you = an determine exactly how long it is:</p>
<pre class="r"><code>dyears(1) / ddays(1)
#&gt; [1] 365.25
years(1) / days(1)
#&gt; [1] 365.25</code></pre>
<pre class="r"><code>date &lt;- ymd(&quot;2020-01-01&quot;)
next_year &lt;- today() + years(1)
(today() %--% next_year) / ddays(1)
#&gt; [1] 365
(today() %--% next_year) %/% days(1)
#&gt; [1] 365

ymd(&#39;2020-02-29&#39;) + dyears(1)
#&gt; [1] &quot;2021-02-28 06:00:00 UTC&quot;
ymd(&#39;2020-02-29&#39;) + years(1)
#&gt; [1] NA
ymd(&#39;2020-02-29&#39;) %m+% years(1)
#&gt; [1] &quot;2021-02-28&quot;</code></pre>
<pre class="r"><code>#overlap

a1 &lt;- ymd(c(&#39;2021-01-01&#39;, &#39;2021-01-02&#39;, &#39;2021-03-02&#39;))
a2 &lt;- ymd(c(&#39;2021-02-01&#39;, &#39;2021-02-02&#39;, &#39;2021-03-02&#39;))
b1 &lt;- ymd(c(&#39;2021-01-02&#39;, &#39;2021-03-02&#39;, &#39;2021-03-02&#39;))
b2 &lt;- ymd(c(&#39;2021-02-02&#39;, &#39;2021-03-02&#39;, &#39;2021-04-02&#39;))


int_overlaps(interval(a1, a2), interval(b1, b2));
#&gt; [1]  TRUE FALSE  TRUE</code></pre>
<pre class="r"><code>age &lt;- function(dob){
  floor((today() - ymd(dob)) / dyears(1))
}
age(c(&quot;1997-1-1&quot;, &quot;2000-12-31&quot;))
#&gt; [1] 24 20</code></pre></li>
</ul>
</div>
<div id="time-zones" class="section level2">
<h2>Time zones</h2>
<ul>
<li><p>You can find out what R thinks your current time zone is with <code>Sys.timezone()</code>:</p>
<pre class="r"><code>Sys.timezone()
#&gt; [1] &quot;America/Los_Angeles&quot;</code></pre>
<p>(If R doesn’t know, you’ll get an <code>NA</code>.)</p>
<p>And see the complete list of all time zone names with <code>OlsonNames()</code>:</p>
<pre class="r"><code>length(OlsonNames())
#&gt; [1] 593
head(OlsonNames())
#&gt; [1] &quot;Africa/Abidjan&quot;     &quot;Africa/Accra&quot;       &quot;Africa/Addis_Ababa&quot;
#&gt; [4] &quot;Africa/Algiers&quot;     &quot;Africa/Asmara&quot;      &quot;Africa/Asmera&quot;</code></pre>
<p>In R, the time zone is an attribute of the date-time that only controls printing. For example, these three objects represent the same instant in time:</p>
<pre class="r"><code>x1 &lt;- ymd_hms(&quot;2015-06-01 12:01:00&quot;, tz = &quot;America/New_York&quot;)
x2 &lt;- ymd_hms(&quot;2015-06-01 18:01:00&quot;, tz = &quot;Europe/Paris&quot;)
x3 &lt;- ymd_hms(&quot;2015-06-02 01:01:00&quot;, tz = &quot;Asia/Tokyo&quot;)
x4 &lt;- ymd_hms(&quot;2015-06-02 00:01:00&quot;, tz = &quot;Asia/Shanghai&quot;)</code></pre>
<p>You can verify that they’re the same time using subtraction:</p>
<pre class="r"><code>x1 - x2
#&gt; Time difference of 0 secs
x1 - x3
#&gt; Time difference of 0 secs
x1 - x4
#&gt; Time difference of 0 secs</code></pre>
<p>Unless otherwise specified, lubridate always uses UTC. UTC (Coordinated Universal Time) is the standard time zone used by the scientific community and roughly equivalent to its predecessor GMT (Greenwich Mean Time). It does not have DST, which makes a convenient representation for computation. Operations that combine date-times, like <code>c()</code>, will often drop the time zone. In that case, the date-times will display in your local time zone:</p>
<pre class="r"><code>x4 &lt;- c(x1, x2, x3)
x4
#&gt; [1] &quot;2015-06-01 12:01:00 EDT&quot; &quot;2015-06-01 12:01:00 EDT&quot;
#&gt; [3] &quot;2015-06-01 12:01:00 EDT&quot;</code></pre>
<p>You can change the time zone in two ways:</p>
<ul>
<li><p>Keep the instant in time the same, and change how it’s displayed. Use this when the instant is correct, but you want a more natural display.</p>
<pre class="r"><code>x4a &lt;- with_tz(x4, tzone = &quot;Asia/Shanghai&quot;)
x4a
#&gt; [1] &quot;2015-06-02 00:01:00 CST&quot; &quot;2015-06-02 00:01:00 CST&quot;
#&gt; [3] &quot;2015-06-02 00:01:00 CST&quot;
x4a - x4
#&gt; Time differences in secs
#&gt; [1] 0 0 0</code></pre>
<p>(This also illustrates another challenge of times zones: they’re not all integer hour offsets!)</p></li>
<li><p>Change the underlying instant in time. Use this when you have an instant that has been labelled with the incorrect time zone, and you need to fix it.</p>
<pre class="r"><code>x4b &lt;- force_tz(x4, tzone = &quot;Asia/Shanghai&quot;)
x4b
#&gt; [1] &quot;2015-06-01 12:01:00 CST&quot; &quot;2015-06-01 12:01:00 CST&quot;
#&gt; [3] &quot;2015-06-01 12:01:00 CST&quot;
x4b - x4
#&gt; Time differences in hours
#&gt; [1] -12 -12 -12</code></pre></li>
</ul></li>
</ul>
</div>
</div>
<div id="dates-date-stringr-date" class="section level1">
<h1>Dates, date <span class="math inline">\(stringr-date\)</span></h1>
<pre class="r"><code>a &lt;- c(
  &quot;09 Sep 2018 12:00&quot;,
  &quot;19 Sep 2018&quot;,
  &quot;9 unk 2018&quot;,
  &quot;un Sep 2019&quot;,
  &quot;un-Sep-2019&quot;,
  &quot;un unk 2019&quot;,
  &quot;un-unk-19 12:00&quot;,
  &quot;un-unk-2019&quot;,
  &quot;un/unk/99&quot;,
  &quot;un/unk/1999&quot;
)

make_date_10 &lt;- function(indate) {
  outdate &lt;- indate %&gt;% 
    str_to_title() %&gt;% 
    str_extract(&quot;\\w{1,2}\\W*\\D{3}\\W*\\d{2,4}&quot;) %&gt;% 
    str_remove_all(pattern = &quot;\\W&quot;) %&gt;% 
    str_replace(., &quot;^(\\d{1}\\D)(\\w+)&quot;, &quot;0\\1\\2&quot;) %&gt;% 
    str_replace(., &quot;(\\w{2})(\\w{3})(\\d{2,4})&quot;, &quot;\\3\\2\\1&quot;) %&gt;% 
    if_else(str_length(.) == 7,
      (if_else(
        str_replace(., &quot;^(\\d{2})(\\w+)&quot;, &quot;20\\1&quot;) &gt; str_trim(as.character(year(today()))),
        str_replace(., &quot;^(\\d{2})(\\w+)&quot;, &quot;19\\1\\2&quot;),
        str_replace(., &quot;^(\\d{2})(\\w+)&quot;, &quot;20\\1\\2&quot;)
      )),
      .
    ) %&gt;% 
    str_replace_all(c(
      &quot;Jan&quot; = &quot;-01-&quot;,
      &quot;Feb&quot; = &quot;-02-&quot;,
      &quot;Mar&quot; = &quot;-03-&quot;,
      &quot;Apr&quot; = &quot;-04-&quot;,
      &quot;May&quot; = &quot;-05-&quot;,
      &quot;Jun&quot; = &quot;-06-&quot;,
      &quot;Jul&quot; = &quot;-07-&quot;,
      &quot;Aug&quot; = &quot;-08-&quot;,
      &quot;Sep&quot; = &quot;-09-&quot;,
      &quot;Oct&quot; = &quot;-10-&quot;,
      &quot;Nov&quot; = &quot;-11-&quot;,
      &quot;Dec&quot; = &quot;-12-&quot;,
      &quot;UnkUn&quot; = &quot;&quot;,
      &quot;Unk&quot; = &quot;-UN-&quot;,
      &quot;-Un&quot; = &quot;&quot;
    ))
  
  return(outdate)
}

b &lt;- make_date_10(a)
b
#&gt;  [1] &quot;2018-09-09&quot; &quot;2018-09-19&quot; &quot;2018-UN-09&quot; &quot;2019-09&quot;    &quot;2019-09&quot;   
#&gt;  [6] &quot;2019&quot;       &quot;2019&quot;       &quot;2019&quot;       &quot;1999&quot;       &quot;1999&quot;</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
